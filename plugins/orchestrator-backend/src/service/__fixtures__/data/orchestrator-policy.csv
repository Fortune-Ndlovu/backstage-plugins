# An example starter policy with 3 roles, admin, user, and viewer
# workflowViewer role is authorized to only read all workflows and instances run, without being able to run,retrigger, abort, or rerun them.
# workflowUser role is authorized to perform all actions with exeptions to workflows id starting with the string 'prod-'
# workflowAdmin role is authorized to perform all actions on all workflows and workflow instances
# note: role hierarchy is not set in the rbac model yet, hence the repetition.

g, user:default/guest, role:default/workflowViewer
g, user:default/dan, role:default/workflowUser
g, user:development/guest, role:default/workflowAdmin

# viewer
p, role:default/workflowViewer, orchestrator.workflows, read, allow
p, role:default/workflowViewer, orchestrator.workflowInstance, read, allow

# user
p, role:default/workflowUser, orchestrator.workflows, read, allow
p, role:default/workflowUser, orchestrator.workflows, use, allow
p, role:default/workflowUser, orchestrator.workflows.ansible-, read, deny 
p, role:default/workflowUser, orchestrator.workflows.ansible-, use, deny 
p, role:default/workflowUser, orchestrator.workflowInstance, read, allow

# admin
p, role:default/workflowAdmin, orchestrator.workflows, read, allow
p, role:default/workflowAdmin, orchestrator.workflows, use, allow
p, role:default/workflowAdmin, orchestrator.workflowInstance, read, allow


